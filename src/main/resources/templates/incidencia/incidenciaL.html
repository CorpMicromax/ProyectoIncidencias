<div th:fragment="incidenciaL" xmlns:th="http://www.w3.org/1999/xhtml">
    <h4 class="my-4 h-4 font-weight-bold">Incidencias</h4>
    <table id="datatable" class="datatable table-hover table-striped">
        <thead>
        <tr>
            <th> Id </th>
            <th> Titulo </th>
            <th> Categoria </th>
            <th> Creador </th>
            <th> Fecha y Hora de Creacion </th>
            <th> Status </th>
            <th> Editar </th>
            <th> Eliminar </th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${incidencias.empty}">
            <td colspan="2"> No hay incidencias </td>
        </tr>
        <tr th:each="incidencia: ${incidencias}">
            <td><span th:text="${incidencia.idIncidencia}"> Id </span></td>
            <td><span th:text="${incidencia.titulo}"> Titulo </span></td>
            <td><span th:if="${incidencia.categoria}" th:text="${incidencia.categoria.nombre}"></span></td>
            <td><span th:text="${incidencia.creador.nombres}"> Nombre creador </span></td>
            <td><span th:text="${incidencia.creacion}"> creacion </span></td>
            <td><span th:text="${incidencia.status}"> Status </span></td>
            <p data-placement="center" data-toggle="tooltip" title="Delete">

            <td><p data-placement="center" data-toggle="tooltip" title="Editar"><button th:id="${incidencia.idIncidencia}" th:text="Editar" class="editButton btn btn-info btn-rounded btn-sm" data-title="Editar" data-target="#editar" ><span class="glyphicon glyphicon-trash"></span></button></p></td>
            <td><p data-placement="center" data-toggle="tooltip" title="Eliminar"><button th:id="${incidencia.idIncidencia}" th:text="Eliminar" class="deleteCall btn btn-danger btn-rounded btn-sm" data-title="Eliminar" data-toggle="modal" data-target="#delete" ><span class="glyphicon glyphicon-trash"></span></button></p></td>
        </tr>
        </tbody>
    </table>

    <div class="modal fade" id="delete" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                    <h4 class="modal-title custom_align" id="Heading">Eliminar</h4>
                </div>
                <div class="modal-body">

                    <div class="alert alert-danger"><span class="glyphicon glyphicon-warning-sign"></span> Seguro que quiere eliminar?</div>

                </div>
                <div class="modal-footer ">
                    <button type="button" class="deleteButton btn btn-success" ><span class="glyphicon glyphicon-ok-sign"></span> Sí</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> No</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <script th:inline="javascript">
    /*<![CDATA[*/
        var relevant = /*[[${relevant}]]*/ "none";
        $(document).ready( function () {
            $('#datatable').DataTable({
                "language": {
                    "url": /*[[@{/js/localization/spanish.json}]]*/ "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
                }
            });
        });

        $('.editButton').click(function() {
           window.location = "/incidenciaE?id=" + this.id;
        });

        var id = "";
        $('.deleteCall').click(function() {
            id = $(this).attr('id');

        });
        $('.deleteButton').click(function() {
            $.get("/rest/incidencia/incidenciaD", {id: id}, function (response) {
                id = "";
                window.location = "/incidenciaL";
            });
        });
    /*]]>*/
    </script>
</div>
