<div th:fragment="incidenciaL" xmlns:th="http://www.w3.org/1999/xhtml">
    <h4 class="my-4 h-4 font-weight-bold">Incidencias</h4>
    <table id="datatable" class="datatable table-hover table-striped">
        <thead>
        <tr>
            <th> Id </th>
            <th> Titulo </th>
            <th> Categoria </th>
            <th> Creador </th>
            <th> Fecha y Hora de Creacion </th>
            <th> Status </th>
            <th> Editar </th>
            <th> Eliminar </th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${incidencias.empty}">
            <td colspan="2"> No hay incidencias </td>
        </tr>
        <tr th:each="incidencia: ${incidencias}">
            <td><span th:text="${incidencia.idIncidencia}"> Id </span></td>
            <td><span th:text="${incidencia.titulo}"> Titulo </span></td>
            <td><span th:if="${incidencia.categoria}" th:text="${incidencia.categoria.nombre}"></span></td>
            <td><span th:text="${incidencia.creador.nombres}"> Nombre creador </span></td>
            <td><span th:text="${incidencia.creacion}"> creacion </span></td>
            <td><span th:text="${incidencia.status}"> Status </span></td>
            <td><button type="button" class="editButton btn btn-info btn-rounded btn-sm" th:id="${incidencia.idIncidencia}" th:text="Editar"></button></td>
            <td><button type="button" class="deleteButton btn btn-danger btn-rounded btn-sm" th:id="${incidencia.idIncidencia}" th:text="Eliminar"></button></td>
        </tr>
        </tbody>
    </table>
    <script th:inline="javascript">
    /*<![CDATA[*/
        var relevant = /*[[${relevant}]]*/ "none";
        $(document).ready( function () {
            $('#datatable').DataTable({
                "language": {
                    "url": /*[[@{/js/localization/spanish.json}]]*/ "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
                }
            });
        });

        $('.editButton').click(function() {
           window.location = "/incidenciaE?id=" + this.id;
        });


        $('.deleteButton').click(function() {
            var id = $(this).attr('id');
            $.get("/rest/incidencia/incidenciaD", {id: id}, function(response) {
                alert(response);
                window.location = "/incidenciaL";
            });
        });

    /*]]>*/
    </script>
</div>
